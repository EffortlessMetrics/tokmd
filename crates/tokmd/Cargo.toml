[package]
name = "tokmd"
version.workspace = true
edition.workspace = true
license.workspace = true
homepage.workspace = true
repository.workspace = true
description = "Tokei-backed repo inventory receipts (Markdown/TSV/JSONL/CSV) for PRs, CI, and LLM workflows."
readme = "../../README.md"
keywords = ["repo-analysis", "inventory", "llm-context", "receipts", "tokei"]
categories = ["command-line-utilities", "development-tools"]
default-run = "tokmd"
autobins = false
exclude = [
    ".github",
    ".gitignore",
    ".gitattributes",
    "CLAUDE.md",
    "TODO.md",
    "mutants.toml",
    "mutants.out",
    "mutants.out.old",
    "fuzz",
    "tests",
]

[features]
default = ["git", "walk", "content", "ui"]
alias-tok = []
git = ["tokmd-analysis/git", "dep:tokmd-git"]
walk = ["tokmd-analysis/walk"]
content = ["tokmd-analysis/content"]
ui = ["dep:dialoguer", "dep:indicatif", "dep:console", "dep:toml"]

[[bin]]
name = "tokmd"
path = "src/bin/tokmd.rs"

[[bin]]
name = "tok"
path = "src/bin/tok.rs"
required-features = ["alias-tok"]

[dependencies]
anyhow = "1.0.100"
clap = { version = "4.5.56", features = ["derive"] }
tokmd-analysis = { workspace = true }
tokmd-analysis-format = { workspace = true, features = ["fun"] }
tokmd-analysis-types.workspace = true
tokmd-config.workspace = true
tokmd-model.workspace = true
tokmd-scan.workspace = true
tokmd-format.workspace = true
tokmd-tokeignore.workspace = true
tokmd-types.workspace = true
tokmd-git = { workspace = true, optional = true }
clap_complete = "4.5.65"
dialoguer = { version = "0.12.0", optional = true }
console = { version = "0.16.2", optional = true }
indicatif = { version = "0.18.3", optional = true }
toml = { workspace = true, optional = true }
dirs = "6.0.0"
serde_json = "1.0.149"
tokmd-gate.workspace = true
serde = { version = "1.0.228", features = ["derive"] }

[dev-dependencies]
assert_cmd = "2.1.2"
predicates = "3.1.3"
tempfile = "3.24.0"
insta = { version = "1.46.1", features = ["json"] }
regex = "1.12.2"
proptest = "1.9.0"
serde_json = "1.0.149"
tokmd-model.workspace = true
jsonschema = "0.40.2"
