# Compat Run 2026-02-24

## run-20260224-compat-001 (tokmd)

**Goal**: Fix `--no-default-features` build failure in `tokmd` binary.

**Target**: `crates/tokmd/src/commands/`
**Proof Method**: `cargo build --no-default-features` and `cargo test --no-default-features -p tokmd`

**Before**:
- `cargo build --no-default-features` failed due to unresolved import `tokmd_cockpit` in `baseline.rs` and unused imports in `cockpit.rs` and `sensor.rs`.
- Integration tests failed because they expected `git` and `content` features to be present.

**After**:
- `cargo build --no-default-features` passes.
- `cargo build --all-features` passes.
- `cargo test -p tokmd` passes.
- `cargo test --no-default-features -p tokmd` passes (irrelevant tests skipped).

**Changes**:
- `crates/tokmd/src/commands/baseline.rs`: Gated `tokmd_cockpit` usage behind `git` feature.
- `crates/tokmd/src/commands/cockpit.rs`: Gated imports and re-exports behind `git` feature.
- `crates/tokmd/src/commands/sensor.rs`: Gated imports and functions behind `git` feature. Gated tests module.
- `crates/tokmd/tests/baseline_integration.rs`: Gated determinism test behind `git` feature.
- `crates/tokmd/tests/cockpit_integration.rs`: Gated entire file behind `git` feature.
- `crates/tokmd/tests/sensor_integration.rs`: Gated entire file behind `git` feature.
- `crates/tokmd/tests/docs.rs`: Gated `recipe_gate_with_baseline` behind `content` feature (as it depends on complexity metrics).

**Verification**:
- `cargo build --no-default-features` -> OK
- `cargo build --all-features` -> OK
- `cargo test -p tokmd` -> OK
- `cargo test --no-default-features -p tokmd` -> OK
