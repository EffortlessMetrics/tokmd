# Sentinel Run 2024-04-01

**Lane**: [placeholder]
**Target**: [placeholder]

## Findings
- Found `expect("unknown analysis preset")` in `crates/tokmd/src/analysis_utils.rs` inside `map_preset`.
- The mapping roundtrips an enum to string via `Debug` formatting and `.to_lowercase()` then parses back to another enum variant using `from_str`.
- This is a crash risk if the enums drift, and causes unnecessary allocations.
- A match block is compile-time checked and panic-free.

## Options considered
### Option A (recommended)
- Replace string formatting/parsing with an exhaustive `match` block mapping `cli::AnalysisPreset` to `analysis::AnalysisPreset` directly.
- Why it fits: Solves the panic risk entirely. Fast. Compile-time safe. Adheres to "unwrap/expect/panic burndown".
- Trade-offs: Structure is more verbose. Velocity increases as it catches enum drift at compile time.

### Option B
- Wrap the formatting in `Result` and propagate errors upwards instead of panicking.
- When to choose: When matching is impossible due to external trait bounds.
- Trade-offs: Still relies on string parsing, runtime overhead remains, and error handling bubbles up to CLI level unnecessarily for what should be a static mapping.

## Decision
- Proceeding with Option A. It completely removes the `expect` and `unwrap_or` calls, while being safer and more efficient.
