name: Bug Report
description: Report a bug or unexpected behavior in tokmd
title: "[Bug]: "
labels: ["bug", "triage"]
body:
  - type: markdown
    attributes:
      value: |
        Thanks for taking the time to report a bug! Please fill out the sections below to help us investigate.

        **Before submitting**, please check:
        - [ ] I searched [existing issues](https://github.com/EffortlessMetrics/tokmd/issues) and this hasn't been reported
        - [ ] I'm using the latest version of tokmd

  - type: textarea
    id: description
    attributes:
      label: Bug Description
      description: A clear and concise description of what the bug is.
      placeholder: What went wrong?
    validations:
      required: true

  - type: textarea
    id: reproduce
    attributes:
      label: Steps to Reproduce
      description: Minimal steps to reproduce the behavior.
      placeholder: |
        1. Clone/create a repo with: `...`
        2. Run `tokmd ...`
        3. See error
      value: |
        1.
        2.
        3.
    validations:
      required: true

  - type: textarea
    id: expected
    attributes:
      label: Expected Behavior
      description: What did you expect to happen?
    validations:
      required: true

  - type: textarea
    id: actual
    attributes:
      label: Actual Behavior
      description: What actually happened? Include any error messages.
    validations:
      required: true

  - type: dropdown
    id: command
    attributes:
      label: Affected Command
      description: Which tokmd command exhibits the bug?
      options:
        - lang (default)
        - module
        - export
        - run
        - analyze
        - cockpit
        - gate
        - badge
        - diff
        - context
        - tools
        - init
        - check-ignore
        - completions
        - Multiple commands
        - Not command-specific
    validations:
      required: true

  - type: dropdown
    id: output_format
    attributes:
      label: Output Format
      description: Which output format were you using?
      options:
        - Markdown (default)
        - JSON
        - JSONL
        - CSV
        - TSV
        - CycloneDX
        - SVG
        - Not applicable
    validations:
      required: false

  - type: input
    id: version
    attributes:
      label: tokmd Version
      description: "Output of `tokmd --version`"
      placeholder: "tokmd 1.3.1"
    validations:
      required: true

  - type: dropdown
    id: installation
    attributes:
      label: Installation Method
      options:
        - cargo install tokmd
        - cargo install --git
        - Built from source
        - GitHub Release binary
        - Homebrew
        - Nix
        - Docker
        - Other
    validations:
      required: true

  - type: dropdown
    id: os
    attributes:
      label: Operating System
      options:
        - Linux
        - macOS (Apple Silicon)
        - macOS (Intel)
        - Windows
        - WSL
        - Other
    validations:
      required: true

  - type: input
    id: os_version
    attributes:
      label: OS Version
      description: "e.g., Ubuntu 24.04, macOS 15.2, Windows 11 23H2"
      placeholder: "Ubuntu 24.04"

  - type: input
    id: rust_version
    attributes:
      label: Rust Version (if built from source)
      description: "Output of `rustc --version`"
      placeholder: "rustc 1.84.0 (9fc6b43 2025-01-07)"

  - type: textarea
    id: logs
    attributes:
      label: Error Output / Logs
      description: |
        Paste any error messages or relevant output.
        Tip: Run with `RUST_BACKTRACE=1` for more details.
      render: shell

  - type: textarea
    id: reproduction_repo
    attributes:
      label: Reproduction Repository (Optional)
      description: |
        If this bug is specific to a repository structure, please provide:
        - A link to a public repo that reproduces the issue, OR
        - A minimal directory structure description
      placeholder: |
        https://github.com/example/repo

        Or describe the structure:
        ```
        myproject/
        ├── src/
        │   └── main.rs
        └── Cargo.toml
        ```

  - type: textarea
    id: context
    attributes:
      label: Additional Context
      description: Any other context about the problem (screenshots, workarounds tried, etc.)

  - type: checkboxes
    id: terms
    attributes:
      label: Code of Conduct
      options:
        - label: I agree to follow this project's Code of Conduct
          required: true
